{% extends "BenLogementBundle::layout.html.twig" %}
{% block title %}
Elaboration des listes | {{ parent() }}
{% endblock %}
{% block body %}

<form  id="form1" role="form" method="post" action=""> 
 <h3><span class="glyphicon glyphicon-user"></span> Elaboration des listes
 <div class="pull-right hidden-print">
  <a href="#" class="btn btn-primary" data-toggle="modal" data-target="#infoModal"><span class="glyphicon glyphicon-cog"></span> université</a>
   {% if entities %}<a href="#" class="btn btn-primary" id="js-submit"><span class="glyphicon glyphicon-ok-circle"></span> Confirmer</a>{% endif %}
   <a id="btnPrint" class="btn btn-primary" href="#"><span class="glyphicon glyphicon-print"></span> Imprimer</a>
 </div>
</h3>

      <!-- Modal -->
<div class="modal fade" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="infoModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <div class="col-md-3 pull-right">
          <select  name="gender" class="form-control">
            <option value="Fille" >Fille</option>
            <option value="Garçon" >Garçon</option>
          </select>
          </div>
        <h4 class="modal-title" id="infoModalLabel"><span class="glyphicon glyphicon-user"></span> Nombre de candidat éligible</h4>

      </div>
      <div class="modal-body">
        {% for entity in universities %}
        <div class="col-md-12">
          <div class="form-group">
            <label class="col-md-10 control-label" for=""><small>{{entity.name}}</small></label>
            <div class="col-md-2 form-group">
              <input class="form-control" id="" type="number" name="quota[{{entity.id}}]">
            </div>
          </div>
        </div> 
        {% endfor %}
        <div class="clearfix"></div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-ok-circle"></span> Lancer</button>
      </div>
    </div>
  </div>
</div>
  </form>
  <form  id="form2" role="form" method="post" action="{{ path('etudiant_validate_list') }}">
    <table class="table table-striped table-hover table-bordered">
        <thead>
            <tr>
                <th>#</th>
                <th>Dossier</th>
                <th>Nom</th>
                <th class="hidden-print">Type</th>
                <th>CIN</th>
                <th>CNE</th>
                <th class="hidden-print">Note</th>
            </tr>
        </thead>
        <tbody id="dataContainer">
        {% set i = 0 %}
        {% for e in entities %}
        <tr class="info hidden-print"><td colspan="10">{{ e[0].etablissement }} <span class="badge pull-right">{{ e|length }}</span></td></tr>
        {% for entity in e %}
        {% set i = i+1 %}
            <tr>
                <td>{{ i }} <input type="hidden" name="entities[]" value="{{ entity.id }}"></td>
                <td>{{ entity.ndossier }}</td>
                <td>{{ entity.fullName }}</td>
                <td class="hidden-print">{{ entity.type }}</td>
                <td>{{ entity.cin }}</td>
                <td>{{ entity.cne }}</td>
                <td class="hidden-print">{{ entity.note }}</td>
            </tr>
        {% endfor %}
        {% endfor %}
        </tbody>
    </table>
  </form>

{% endblock body %}
{% block javascripts %}
{{ parent() }}
<script> 
    (function($) {

        $('#js-submit').on('click', function(){
            $('#form2').submit();
            return false;
        });
    })(jQuery);
</script>
{% endblock %}